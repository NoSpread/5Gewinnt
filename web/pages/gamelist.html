<html>
    <head>
        <title>Live Game List</title>
        <script>
            function loadGameList() {
                var xhttp = new XMLHttpRequest();

                xhttp.onreadystatechange = function() {
                    if (this.readyState == 4 && this.status == 200) {
                        var gameList = JSON.parse(this.responseText);
                        var table = document.getElementById('gameList');

                        while (table.firstChild) {
                            table.removeChild(table.firstChild);
                        }

                        for (let i = 0; i < gameList.length; i++) {
                            let newRow = document.createElement('tr');

                            let id = gameList[i].id;
                            let idCell = document.createElement('td');
                            let linkCell = document.createElement('a');
                            idCell.appendChild(linkCell);
                            linkCell.appendChild(document.createTextNode(id))
                            linkCell.href = 'gameboard.php?id=' + id;

                            let playerCell = document.createElement('td');
                            playerCell.appendChild(document.createTextNode(gameList[i].player1));

                            newRow.appendChild(idCell);
                            newRow.appendChild(playerCell);

                            table.appendChild(newRow);
                        }
                    }
                };

                xhttp.open('GET', '../res/php/getgamelist.php', true);
                xhttp.send();
            }

            function startLoading() {
                setInterval(loadGameList, 1000);
            }
        </script>
    </head>
    <body onload='startLoading();'>
        <h1>Live Game List &#129354;</h1>
        <table border='1'>
            <thead>
                <tr>
                    <th>Game ID</th>
                    <th>Challenging Player</th>
                <tr>
            </thead>
            <tbody id='gameList'></tbody>
        </table>
    </body>
</html>
